#include <stdlib.h>
#include <string.h>
#include <stdio.h>
#include "p256.h"

static void test(void)
{
    char *msg = "This is a secret";
    unsigned char sig[64] = {

        /* r */
    0x97,0xFF,0x36,0x97,0xA8,0x61,0x12,0x17,
    0x8A,0x3C,0xC4,0xE1,0x2C,0x67,0x1A,0x28,
    0x3A,0x8F,0x90,0xA4,0x6F,0x40,0xD8,0x9E,
    0x17,0xD9,0x21,0xC6,0x91,0xB1,0xD2,0x16,
 
        /* s */
    0xA2,0x72,0xCF,0x3E,0x7C,0x01,0x8B,0xC6,
    0x7E,0x74,0x42,0xBB,0x70,0x00,0x3E,0x20,
    0x30,0x3D,0x43,0x76,0x03,0xF3,0x46,0x0F,
    0xDE,0x78,0xD0,0xE3,0x38,0xAF,0xB0,0xC6
     };
    const unsigned char pk[] = {
        /* constant */ 0x04,

        /* x-coord */
        0xc9,0x7e,0xef,0xe5,0x27,0xeb,0x9a,0x76,
	0xb0,0x07,0xa1,0xd4,0x2d,0xdf,0x52,0x60,
	0x42,0x64,0xf9,0xf4,0x34,0x7b,0xee,0x95,
	0x8e,0x53,0xbc,0x16,0xa9,0x83,0x5a,0xb8,

        /* y-coord */
	0x0d,0x11,0xf2,0x4f,0x1b,0xa0,0x37,0xb2,
	0x88,0x46,0xf2,0x30,0xd0,0xab,0x87,0xbb,
	0xef,0x7e,0x2f,0xfd,0xde,0xc9,0x4f,0x26,
	0x86,0x7a,0x20,0x40,0x83,0x7f,0x48,0x4d
    };

    if (p256_verify((uint8_t *)msg, strlen(msg), sig, pk) != P256_SUCCESS) {
        printf("error\n");
    } else {
        printf("OK\n");
    }
    return;
}

int main(int argc, char **argv)
{
    (void)argc;
    (void)argv;
    test();
}
